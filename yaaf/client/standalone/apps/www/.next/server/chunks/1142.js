"use strict";exports.id=1142,exports.ids=[1142,3814,4846,3466,3491],exports.modules={3491:(e,t,r)=>{r.r(t),r.d(t,{useAudioRecording:()=>n});var a=r(7577),l=r(3466);function n({transcribeAudio:e,onTranscriptionComplete:t}){let[r,n]=(0,a.useState)(!1),[i,s]=(0,a.useState)(!!e),[o,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(!1),[p,m]=(0,a.useState)(null),f=(0,a.useRef)(null),x=async()=>{c(!1),d(!0);try{l.recordAudio.stop();let r=await f.current;if(e){let a=await e(r);t?.(a)}}catch(e){console.error("Error transcribing audio:",e)}finally{d(!1),n(!1),p&&(p.getTracks().forEach(e=>e.stop()),m(null)),f.current=null}},h=async()=>{if(r)await x();else try{n(!0),c(!0);let e=await navigator.mediaDevices.getUserMedia({audio:!0});m(e),f.current=(0,l.recordAudio)(e)}catch(e){console.error("Error recording audio:",e),n(!1),c(!1),p&&(p.getTracks().forEach(e=>e.stop()),m(null))}};return{isListening:r,isSpeechSupported:i,isRecording:o,isTranscribing:u,audioStream:p,toggleListening:h,stopRecording:x}}},3814:(e,t,r)=>{r.r(t),r.d(t,{useAutosizeTextArea:()=>l});var a=r(7577);function l({ref:e,maxHeight:t=Number.MAX_SAFE_INTEGER,borderWidth:r=0,dependencies:l}){(0,a.useRef)(null)}},3466:(e,t,r)=>{r.r(t),r.d(t,{recordAudio:()=>a});let a=function(){let e=async function(t){try{let r=new MediaRecorder(t,{mimeType:"audio/webm;codecs=opus"}),a=[];return new Promise((t,l)=>{r.ondataavailable=e=>{e.data.size>0&&a.push(e.data)},r.onstop=()=>{let e=new Blob(a,{type:"audio/webm"});t(e)},r.onerror=()=>{l(Error("MediaRecorder error occurred"))},r.start(1e3),e.currentRecorder=r})}catch(e){throw Error("Failed to start recording: "+(e instanceof Error?e.message:"Unknown error occurred"))}};return e.stop=()=>{let t=e.currentRecorder;t&&"inactive"!==t.state&&t.stop(),delete e.currentRecorder},e}()},4846:(e,t,r)=>{r.r(t),r.d(t,{AudioVisualizer:()=>n});var a=r(326),l=r(7577);function n({stream:e,isRecording:t,onClick:r}){let n=(0,l.useRef)(null);(0,l.useRef)(null),(0,l.useRef)(null),(0,l.useRef)();let i=(0,l.useRef)(null);return a.jsx("div",{ref:i,className:"h-full w-full cursor-pointer rounded-lg bg-background/80 backdrop-blur",onClick:r,children:a.jsx("canvas",{ref:n,className:"h-full w-full"})})}},4741:(e,t,r)=>{r.r(t),r.d(t,{InterruptPrompt:()=>s});var a=r(326),l=r(8450),n=r(8134),i=r(3861);function s({isOpen:e,close:t}){return a.jsx(l.M,{children:e&&(0,a.jsxs)(n.E.div,{initial:{top:0,filter:"blur(5px)"},animate:{top:-40,filter:"blur(0px)",transition:{type:"spring",filter:{type:"tween"}}},exit:{top:0,filter:"blur(5px)"},className:"absolute left-1/2 flex -translate-x-1/2 overflow-hidden whitespace-nowrap rounded-full border bg-background py-1 text-center text-sm text-muted-foreground",children:[a.jsx("span",{className:"ml-2.5",children:"Press Enter again to interrupt"}),a.jsx("button",{className:"ml-1 mr-2.5 flex items-center",type:"button",onClick:t,"aria-label":"Close",children:a.jsx(i.Z,{className:"h-3 w-3"})})]})})}},1142:(e,t,r)=>{r.r(t),r.d(t,{MessageInput:()=>v});var a=r(326),l=r(7577),n=r(8450),i=r(8134),s=r(7781),o=r(1290),c=r(1517),u=r(9844),d=r(4256),p=r(6368),m=r(6511),f=r(7863),x=r(3491),h=r(3814),b=r(4846),g=r(1613),w=r(9547),y=r(4741);function v({placeholder:e="Ask AI...",className:t,onKeyDown:r,submitOnEnter:i=!0,stop:d,isGenerating:p,enableInterrupt:b=!0,transcribeAudio:v,...A}){let[R,z]=(0,l.useState)(!1),[E,D]=(0,l.useState)(!1),{isListening:S,isSpeechSupported:T,isRecording:C,isTranscribing:M,audioStream:F,toggleListening:P,stopRecording:Z}=(0,x.useAudioRecording)({transcribeAudio:v,onTranscriptionComplete:e=>{A.onChange?.({target:{value:e}})}}),I=e=>{A.allowAttachments&&A.setFiles(t=>null===t?e:null===e?t:[...t,...e])},V=(0,l.useRef)(null),[K,O]=(0,l.useState)(0),q=A.allowAttachments&&A.files&&A.files.length>0;return(0,h.useAutosizeTextArea)({ref:V,maxHeight:240,borderWidth:1,dependencies:[A.value,q]}),(0,a.jsxs)("div",{className:"relative flex w-full",onDragOver:e=>{!0===A.allowAttachments&&(e.preventDefault(),z(!0))},onDragLeave:e=>{!0===A.allowAttachments&&(e.preventDefault(),z(!1))},onDrop:e=>{if(z(!1),!0!==A.allowAttachments)return;e.preventDefault();let t=e.dataTransfer;t.files.length&&I(Array.from(t.files))},children:[b&&a.jsx(y.InterruptPrompt,{isOpen:E,close:()=>D(!1)}),a.jsx(N,{isVisible:C,onStopRecording:Z}),a.jsx("div",{className:"relative flex w-full items-center space-x-2",children:(0,a.jsxs)("div",{className:"relative flex-1",children:[a.jsx("textarea",{"aria-label":"Write your prompt here",placeholder:e,ref:V,onPaste:e=>{let t=e.clipboardData?.items;if(!t)return;let r=e.clipboardData.getData("text");if(r&&r.length>500&&A.allowAttachments){e.preventDefault(),I([new File([new Blob([r],{type:"text/plain"})],"Pasted text",{type:"text/plain",lastModified:Date.now()})]);return}let a=Array.from(t).map(e=>e.getAsFile()).filter(e=>null!==e);A.allowAttachments&&a.length>0&&I(a)},onKeyDown:e=>{if(i&&"Enter"===e.key&&!e.shiftKey){if(e.preventDefault(),p&&d&&b){if(E)d(),D(!1),e.currentTarget.form?.requestSubmit();else if(A.value||A.allowAttachments&&A.files?.length){D(!0);return}}e.currentTarget.form?.requestSubmit()}r?.(e)},className:(0,f.cn)("z-10 w-full grow resize-none rounded-xl border border-input bg-background p-3 pr-24 text-sm ring-offset-background transition-[border] placeholder:text-muted-foreground focus-visible:border-primary focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",q&&"pb-16",t),...A.allowAttachments?(0,m.a)(A,["allowAttachments","files","setFiles"]):(0,m.a)(A,["allowAttachments"])}),A.allowAttachments&&a.jsx("div",{className:"absolute inset-x-3 bottom-0 z-20 overflow-x-scroll py-3",children:a.jsx("div",{className:"flex space-x-3",children:a.jsx(n.M,{mode:"popLayout",children:A.files?.map(e=>a.jsx(w.FilePreview,{file:e,onRemove:()=>{A.setFiles(t=>{if(!t)return null;let r=Array.from(t).filter(t=>t!==e);return 0===r.length?null:r})}},e.name+String(e.lastModified)))})})})]})}),(0,a.jsxs)("div",{className:"absolute right-3 top-3 z-20 flex gap-2",children:[A.allowAttachments&&a.jsx(g.z,{type:"button",size:"icon",variant:"outline",className:"h-8 w-8","aria-label":"Attach a file",onClick:async()=>{I(await function(){let e=document.createElement("input");return e.type="file",e.multiple=!0,e.accept="*/*",e.click(),new Promise(t=>{e.onchange=e=>{let r=e.currentTarget.files;if(r){t(Array.from(r));return}t(null)}})}())},children:a.jsx(s.Z,{className:"h-4 w-4"})}),T&&a.jsx(g.z,{type:"button",variant:"outline",className:(0,f.cn)("h-8 w-8",S&&"text-primary"),"aria-label":"Voice input",size:"icon",onClick:P,children:a.jsx(o.Z,{className:"h-4 w-4"})}),p&&d?a.jsx(g.z,{type:"button",size:"icon",className:"h-8 w-8","aria-label":"Stop generating",onClick:d,children:a.jsx(c.Z,{className:"h-3 w-3 animate-pulse",fill:"currentColor"})}):a.jsx(g.z,{type:"submit",size:"icon",className:"h-8 w-8 transition-opacity","aria-label":"Send message",disabled:""===A.value||p,children:a.jsx(u.Z,{className:"h-5 w-5"})})]}),A.allowAttachments&&a.jsx(j,{isDragging:R}),a.jsx(k,{isRecording:C,isTranscribing:M,audioStream:F,textAreaHeight:K,onStopRecording:Z})]})}function j({isDragging:e}){return a.jsx(n.M,{children:e&&(0,a.jsxs)(i.E.div,{className:"pointer-events-none absolute inset-0 z-20 flex items-center justify-center space-x-2 rounded-xl border border-dashed border-border bg-background text-sm text-muted-foreground",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},"aria-hidden":!0,children:[a.jsx(s.Z,{className:"h-4 w-4"}),a.jsx("span",{children:"Drop your files here to attach them."})]})})}function A(){return(0,a.jsxs)(i.E.div,{className:"flex h-full w-full flex-col items-center justify-center rounded-xl bg-background/80 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[(0,a.jsxs)("div",{className:"relative",children:[a.jsx(d.Z,{className:"h-8 w-8 animate-spin text-primary"}),a.jsx(i.E.div,{className:"absolute inset-0 h-8 w-8 animate-pulse rounded-full bg-primary/20",initial:{scale:.8,opacity:0},animate:{scale:1.2,opacity:1},transition:{duration:1,repeat:1/0,repeatType:"reverse",ease:"easeInOut"}})]}),a.jsx("p",{className:"mt-4 text-sm font-medium text-muted-foreground",children:"Transcribing audio..."})]})}function N({isVisible:e,onStopRecording:t}){return a.jsx(n.M,{children:e&&a.jsx(i.E.div,{initial:{top:0,filter:"blur(5px)"},animate:{top:-40,filter:"blur(0px)",transition:{type:"spring",filter:{type:"tween"}}},exit:{top:0,filter:"blur(5px)"},className:"absolute left-1/2 flex -translate-x-1/2 cursor-pointer overflow-hidden whitespace-nowrap rounded-full border bg-background py-1 text-center text-sm text-muted-foreground",onClick:t,children:(0,a.jsxs)("span",{className:"mx-2.5 flex items-center",children:[a.jsx(p.Z,{className:"mr-2 h-3 w-3"}),"Click to finish recording"]})})})}function k({isRecording:e,isTranscribing:t,audioStream:r,textAreaHeight:l,onStopRecording:n}){return e?a.jsx("div",{className:"absolute inset-[1px] z-50 overflow-hidden rounded-xl",style:{height:l-2},children:a.jsx(b.AudioVisualizer,{stream:r,isRecording:e,onClick:n})}):t?a.jsx("div",{className:"absolute inset-[1px] z-50 overflow-hidden rounded-xl",style:{height:l-2},children:a.jsx(A,{})}):null}v.displayName="MessageInput"}};